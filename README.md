# Проект: Эмоциональная классификация речи с использованием нейронных сетей

Этот проект направлен на классификацию эмоций в аудиофайлах с использованием нейронной сети. В качестве данных используется датасет RAVDESS, который содержит записи эмоций на основе речи и песен. Мы используем этот датасет для создания модели, которая будет способна распознавать эмоции, такие как спокойствие, радость, грусть, злость и другие, исходя из аудиофайлов.

Датасет можно найти на [Kaggle](https://www.kaggle.com/datasets/uwrfkaggler/ravdess-emotional-speech-audio/data).

## Описание файлов

1. **data_preparation.py**: Скрипт для подготовки данных:
   - Загружает аудиофайлы.
   - Извлекает признаки MFCC (Mel-Frequency Cepstral Coefficients) из аудио.
   - Преобразует метки эмоций в числовой формат для обучения модели.
   - Разбивает данные на тренировочные, валидационные и тестовые наборы.
   - Сохраняет обработанные данные в формате `.npy`, который оптимален для работы с массивами числовых данных.

2. **model_training.py**: Скрипт для обучения модели:
   - Загружает подготовленные данные из файлов `.npy`.
   - Масштабирует данные для улучшения качества обучения.
   - Применяет аугментацию данных для улучшения обобщающих способностей модели (например, добавление шума, изменение скорости воспроизведения, высоты тона и сдвиг времени).
   - Строит и обучает нейронную сеть с использованием residual connections (оставляющие связи) для классификации эмоций.
   - Оценивает модель по метрикам точности и F1, а также строит confusion matrix и графики точности.

## Методология

Для анализа эмоций в аудиофайлах мы используем **нейронную сеть** с архитектурой на основе полносвязных слоев (`Dense`), а также добавлением слоев для нормализации и регуляризации (Batch Normalization и Dropout). Это позволяет нейронной сети более эффективно обучаться и предотвращать переобучение.

Мы выбрали **нейронную сеть** для решения этой задачи по следующим причинам:
- **Глубокие нейронные сети** способны выявлять сложные закономерности в данных, которые сложно поддаются традиционным методам обработки сигналов или статистическим подходам.
- Для обработки аудио наилучшим образом подходят **спектральные признаки**, такие как **MFCC**, которые эффективно кодируют важную информацию о звуках, используемую при различении эмоций в речи.
- Нейронные сети, обученные на большом количестве данных, могут достичь высокой точности в задачах классификации, таких как наша.

### Почему мы выбрали нейронную сеть с residual connections?

Мы использовали архитектуру с **residual connections** (или остаточными связями) для улучшения обучения и повышения точности модели. Эти связи позволяют модели легче передавать информацию между слоями, что важно при обучении глубоких сетей. Residual блоки помогают бороться с проблемой исчезающего градиента, ускоряют сходимость модели и позволяют эффективно использовать более глубокие архитектуры без потери производительности.

## Этапы проекта

1. **Подготовка данных**:
   - В аудиофайлах извлекаются признаки **MFCC**, которые представляют собой коэффициенты, описывающие мел-спектр частот. Эти признаки используются для кодирования важной информации о частотных составляющих звука.
   - Аудиофайлы разделяются на тренировочные, валидационные и тестовые наборы с помощью `train_test_split`.
   - Все данные сохраняются в формате `.npy` для удобства и скорости загрузки в дальнейшем.

2. **Аугментация данных**:
   - Для увеличения разнообразия данных и улучшения обобщающих способностей модели применяется аугментация:
     - **Добавление шума**: Слегка изменяет аудиофайл, добавляя случайный шум, что помогает модели научиться распознавать эмоции на шумных данных.
     - **Изменение скорости и высоты тона**: Составляет различные варианты одного и того же аудиофайла с разными характеристиками, что позволяет увеличить количество тренировочных примеров.
     - **Сдвиг во времени**: Вводит небольшие смещения в данных, чтобы модель могла адаптироваться к небольшим вариациям в синхронизации речи.

3. **Модель**:
   - Мы строим модель на основе **Keras**, используя слои типа `Dense` с добавлением нормализации и регуляризации для предотвращения переобучения. 
   - Включение **residual блоков** помогает модели глубже анализировать данные и улучшить точность, что критично для задач распознавания эмоций.

4. **Обучение и оценка**:
   - Мы используем **EarlyStopping** для предотвращения переобучения и **ReduceLROnPlateau** для уменьшения скорости обучения, если улучшения точности замедляются.
   - Модель оценивается по **точности** и **F1-метрике**. Эти метрики подходят для оценки эффективности классификации, особенно когда важно как можно точнее распознавать эмоции, даже если их распределение в выборке неравномерное.

## Используемые библиотеки

- **librosa** — для извлечения аудиофич, таких как MFCC.
- **numpy** — для работы с массивами данных.
- **scikit-learn** — для метрик, таких как точность и F1.
- **tensorflow (Keras)** — для построения и обучения нейронной сети.
- **matplotlib, seaborn** — для визуализации результатов, графиков точности и confusion matrix.

## Запуск

1. Установите необходимые библиотеки:
   ```bash
   python -m venv venv
   venv/Scripts/Activate
   pip install -r requirements.txt
   ```
2. Запустите скрипты:
Подготовка данных: python data_preparation.py
Обучение модели: python model_training.py


Примечания
Датасет был взят с Kaggle.
Модель классифицирует эмоции, такие как: спокойствие, радость, грусть, злость, удивление и другие.
Для улучшения результатов можно экспериментировать с гиперпараметрами модели и методами аугментации данных.

